# Generated by Django 5.0 on 2026-02-25 14:31

import django.core.validators
import django.db.models.deletion
import simple_history.models
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('customers', '0003_currency_interestratebcv_exchangerate'),
        ('payroll_core', '0057_employee_last_endowment_date_endowmentevent'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='HistoricalCompany',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('name', models.CharField(max_length=200, verbose_name='Razón Social')),
                ('rif', models.CharField(help_text='J-12345678-9', max_length=20, verbose_name='RIF')),
                ('email', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Email Corporativo')),
                ('phone', models.CharField(blank=True, max_length=50, null=True, verbose_name='Teléfono')),
                ('website', models.URLField(blank=True, null=True, verbose_name='Sitio Web')),
                ('address', models.TextField(blank=True, null=True, verbose_name='Dirección Fiscal')),
                ('city', models.CharField(blank=True, max_length=100, null=True, verbose_name='Ciudad')),
                ('state', models.CharField(blank=True, max_length=100, null=True, verbose_name='Estado')),
                ('logo', models.TextField(blank=True, max_length=100, null=True, verbose_name='Logo')),
                ('primary_color', models.CharField(default='#3b82f6', max_length=7, verbose_name='Color Primario')),
                ('national_minimum_salary', models.DecimalField(decimal_places=2, default=Decimal('130.00'), help_text='Base para deducciones de ley (IVSS, RPE)', max_digits=18, verbose_name='Salario Mínimo Nacional')),
                ('base_currency_symbol', models.CharField(default='Bs.', max_length=5, verbose_name='Símbolo Moneda Base')),
                ('salary_split_mode', models.CharField(choices=[('PERCENTAGE', 'Porcentaje (Base = % del Total)'), ('FIXED_BASE', 'Base Fija + Complemento Variable'), ('FIXED_BONUS', 'Complemento Fijo + Base Variable')], default='PERCENTAGE', help_text='Cómo se divide el salario total entre base y complemento', max_length=15, verbose_name='Modo de Distribución Salarial')),
                ('split_percentage_base', models.DecimalField(decimal_places=2, default=Decimal('30.00'), help_text='Para modo PERCENTAGE: porcentaje del total que es sueldo base (ej: 30.00)', max_digits=5, validators=[django.core.validators.MinValueValidator(Decimal('0.00')), django.core.validators.MaxValueValidator(Decimal('100.00'))], verbose_name='Porcentaje Base (%)')),
                ('payroll_journey', models.CharField(choices=[('WEEKLY', 'Semanal'), ('BIWEEKLY', 'Quincenal'), ('MONTHLY', 'Mensual')], default='BIWEEKLY', max_length=10, verbose_name='Frecuencia de Nómina Principal')),
                ('cestaticket_journey', models.CharField(choices=[('MONTHLY', 'Mensual (Única fecha)'), ('PERIODIC', 'Proporcional en cada pago')], default='MONTHLY', max_length=10, verbose_name='Frecuencia de Cestaticket')),
                ('cestaticket_payment_day', models.PositiveSmallIntegerField(default=30, help_text='Si es mensual, día del mes en que se abona (ej: 30 para fin de mes)', verbose_name='Día de Pago Cestaticket')),
                ('show_base_salary', models.BooleanField(default=True, verbose_name='Mostrar Sueldo Base en Recibo')),
                ('show_supplement', models.BooleanField(default=True, verbose_name='Mostrar Complemento en Recibo')),
                ('show_tickets', models.BooleanField(default=True, verbose_name='Mostrar Cestaticket en Recibo')),
                ('show_seniority', models.BooleanField(default=True, verbose_name='Mostrar Antigüedad en Recibo')),
                ('vacation_salary_basis', models.CharField(choices=[('BASE_ONLY', 'Solo Sueldo Base'), ('BASE_PLUS_COMPLEMENT', 'Sueldo Base + Complemento (Paquete Total)')], default='BASE_PLUS_COMPLEMENT', help_text='Define qué componentes del sueldo inciden en el pago de vacaciones', max_length=25, verbose_name='Base Salarial para Vacaciones')),
                ('vacation_receipt_currency', models.CharField(choices=[('USD', 'Dólares (USD)'), ('VES', 'Bolívares (Bs.)'), ('DUAL', 'Ambas Monedas')], default='USD', help_text='En qué moneda se muestran los montos del recibo PDF', max_length=10, verbose_name='Moneda del Recibo de Vacaciones')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Configuración de Empresa',
                'verbose_name_plural': 'historical Configuración de Empresa',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalDepartment',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField()),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('branch', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.branch')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('supervisor', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.department')),
            ],
            options={
                'verbose_name': 'historical Departamento',
                'verbose_name_plural': 'historical Departamentos',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalEmployee',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('first_name', models.CharField(max_length=100, verbose_name='Nombres')),
                ('last_name', models.CharField(max_length=100, verbose_name='Apellidos')),
                ('second_name', models.CharField(blank=True, help_text='Requerido para archivos planos FAOV/IVSS', max_length=50, verbose_name='Segundo Nombre')),
                ('second_last_name', models.CharField(blank=True, help_text='Requerido para archivos planos FAOV/IVSS', max_length=50, verbose_name='Segundo Apellido')),
                ('email', models.EmailField(blank=True, db_index=True, max_length=254, null=True, verbose_name='Correo Electrónico')),
                ('phone', models.CharField(blank=True, max_length=20, null=True, verbose_name='Teléfono')),
                ('date_of_birth', models.DateField(blank=True, null=True, verbose_name='Fecha de Nacimiento')),
                ('gender', models.CharField(blank=True, choices=[('M', 'Masculino'), ('F', 'Femenino')], max_length=1, verbose_name='Género')),
                ('marital_status', models.CharField(blank=True, choices=[('S', 'Soltero(a)'), ('M', 'Casado(a)'), ('D', 'Divorciado(a)'), ('W', 'Viudo(a)'), ('C', 'Concubino(a)')], max_length=1, verbose_name='Estado Civil')),
                ('address', models.TextField(blank=True, verbose_name='Dirección')),
                ('nationality', models.CharField(choices=[('V', 'Venezolano(a)'), ('E', 'Extranjero(a)')], default='V', help_text='V=Venezolano, E=Extranjero. Requerido para IVSS/FAOV', max_length=1, verbose_name='Nacionalidad')),
                ('photo', models.TextField(blank=True, max_length=100, null=True)),
                ('national_id', models.CharField(db_index=True, help_text='Formato: V-12345678 o E-12345678', max_length=12, validators=[django.core.validators.RegexValidator(message='La cédula debe tener el formato: V-12345678 o E-12345678', regex='^[VE]-\\d{7,8}$')], verbose_name='Cédula de Identidad')),
                ('rif', models.CharField(blank=True, help_text='Registro de Información Fiscal (opcional)', max_length=12, null=True, validators=[django.core.validators.RegexValidator(message='El RIF debe tener el formato: V-12345678-9', regex='^[JVEGPC]-\\d{8}-\\d$')], verbose_name='RIF Personal')),
                ('ivss_code', models.CharField(blank=True, help_text='Número de afiliación al Instituto Venezolano de los Seguros Sociales', max_length=20, null=True, verbose_name='Código IVSS')),
                ('faov_code', models.CharField(blank=True, help_text='Número de cuenta del Fondo de Ahorro Obligatorio para la Vivienda', max_length=20, null=True, verbose_name='Código FAOV/Banavih')),
                ('employee_code', models.CharField(blank=True, db_index=True, help_text='Código interno del empleado', max_length=20, null=True, verbose_name='Código de Empleado')),
                ('hire_date', models.DateField(help_text='Fecha de inicio de la relación laboral (vital para antigüedad)', verbose_name='Fecha de Ingreso')),
                ('termination_date', models.DateField(blank=True, help_text='Fecha de terminación de la relación laboral', null=True, verbose_name='Fecha de Egreso')),
                ('is_active', models.BooleanField(default=True, help_text='Indica si el empleado está actualmente laborando', verbose_name='Activo')),
                ('position', models.CharField(blank=True, max_length=100, verbose_name='Cargo (Texto Legacy)')),
                ('bank_name', models.CharField(blank=True, max_length=100, verbose_name='Banco')),
                ('bank_account_number', models.CharField(blank=True, help_text='Cuenta para depósito de nómina', max_length=30, verbose_name='Número de Cuenta')),
                ('bank_account_type', models.CharField(blank=True, help_text='Ahorro o Corriente', max_length=20, verbose_name='Tipo de Cuenta')),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Última Actualización')),
                ('shirt_size', models.CharField(blank=True, max_length=20, null=True, verbose_name='Talla de Camisa')),
                ('pants_size', models.CharField(blank=True, max_length=20, null=True, verbose_name='Talla de Pantalón')),
                ('shoe_size', models.CharField(blank=True, max_length=20, null=True, verbose_name='Talla de Calzado')),
                ('last_endowment_date', models.DateField(blank=True, help_text='Fecha de la última dotación entregada', null=True, verbose_name='Última Dotación')),
                ('notes', models.TextField(blank=True, null=True, verbose_name='Observaciones')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('branch', models.ForeignKey(blank=True, db_constraint=False, help_text='Sede a la que pertenece el empleado', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.branch', verbose_name='Sede')),
                ('department', models.ForeignKey(blank=True, db_constraint=False, help_text='Departamento al que pertenece el empleado', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.department', verbose_name='Departamento')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('job_position', models.ForeignKey(blank=True, db_constraint=False, help_text='Cargo asociado de la estructura organizacional', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.jobposition', verbose_name='Cargo Estructurado')),
                ('work_schedule', models.ForeignKey(blank=True, db_constraint=False, help_text='Horario asignado para cálculo de asistencia', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.workschedule', verbose_name='Horario de Trabajo')),
            ],
            options={
                'verbose_name': 'historical Empleado',
                'verbose_name_plural': 'historical Empleados',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalEndowmentEvent',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('date', models.DateField(help_text='Fecha en la que se entregó la dotación', verbose_name='Fecha de Dotación')),
                ('description', models.CharField(help_text='Breve descripción de la dotación (Ej: Uniformes Q1 2026)', max_length=255, verbose_name='Descripción')),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Registro')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('branch', models.ForeignKey(blank=True, db_constraint=False, help_text='Sede a la que fue dirigida la dotación (Opcional)', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.branch', verbose_name='Sede')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Evento de Dotación',
                'verbose_name_plural': 'historical Historial de Dotaciones',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalJobPosition',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('name', models.CharField(help_text='Nombre descriptivo del cargo (ej: Analista Senior)', max_length=100, verbose_name='Nombre del Cargo')),
                ('code', models.CharField(db_index=True, help_text='Código interno único del cargo (ej: ANA-SR-001)', max_length=20, verbose_name='Código')),
                ('description', models.TextField(blank=True, help_text='Descripción de funciones y responsabilidades del cargo', verbose_name='Descripción')),
                ('default_total_salary', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Sueldo mensual base para contratos con este cargo (en moneda seleccionada)', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Sueldo Total Mensual')),
                ('split_fixed_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Monto fijo para usar en estrategias FIXED_BASE o FIXED_BONUS', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Monto Fijo (Estrategia)')),
                ('is_active', models.BooleanField(default=True, help_text='Indica si el cargo está disponible para nuevos contratos', verbose_name='Activo')),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Última Actualización')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('currency', models.ForeignKey(blank=True, db_constraint=False, default='USD', help_text='Moneda del sueldo base (generalmente USD)', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='customers.currency', verbose_name='Moneda')),
                ('department', models.ForeignKey(blank=True, db_constraint=False, help_text='Departamento al que pertenece este cargo', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.department', verbose_name='Departamento')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('split_fixed_currency', models.ForeignKey(blank=True, db_constraint=False, default='USD', help_text='Moneda del monto fijo para la estrategia (ej: USD)', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='customers.currency', verbose_name='Moneda Monto Fijo')),
            ],
            options={
                'verbose_name': 'historical Cargo',
                'verbose_name_plural': 'historical Cargos',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalLaborContract',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('base_salary_bs', models.DecimalField(decimal_places=2, default=0, help_text='Sueldo Base en Bolívares (Fijo)', max_digits=10)),
                ('includes_cestaticket', models.BooleanField(default=True)),
                ('contract_type', models.CharField(choices=[('INDEFINITE', 'Tiempo Indeterminado'), ('FIXED_TERM', 'Tiempo Determinado'), ('PROJECT', 'Por Obra Determinada')], default='INDEFINITE', max_length=20, verbose_name='Tipo de Contrato')),
                ('total_salary_override', models.DecimalField(blank=True, decimal_places=2, help_text='Si se define, sobreescribe el sueldo base del cargo. (Monto Mensual)', max_digits=12, null=True, verbose_name='Override Sueldo Mensual')),
                ('islr_retention_percentage', models.DecimalField(decimal_places=2, default=0, help_text='Porcentaje de retención de ISLR', max_digits=5, verbose_name='Porcentaje de Retención de ISLR')),
                ('salary_amount', models.DecimalField(decimal_places=2, default=0, help_text='Total Paquete Mensual en USD', max_digits=10, verbose_name='Monto del Salario')),
                ('payment_frequency', models.CharField(choices=[('WEEKLY', 'Semanal'), ('BIWEEKLY', 'Quincenal'), ('MONTHLY', 'Mensual')], default='BIWEEKLY', max_length=10, verbose_name='Frecuencia de Pago')),
                ('start_date', models.DateField(help_text='Fecha de inicio del contrato', verbose_name='Fecha de Inicio')),
                ('end_date', models.DateField(blank=True, help_text='Solo para contratos a tiempo determinado', null=True, verbose_name='Fecha de Fin')),
                ('is_active', models.BooleanField(default=True, help_text='Indica si este es el contrato actual del empleado', verbose_name='Vigente')),
                ('position', models.CharField(blank=True, help_text='Cargo según el contrato', max_length=100, null=True, verbose_name='Cargo')),
                ('work_schedule', models.CharField(blank=True, help_text='Ej: Lunes a Viernes 8:00 AM - 5:00 PM', max_length=100, verbose_name='Horario de Trabajo')),
                ('notes', models.TextField(blank=True, verbose_name='Observaciones')),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Última Actualización')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('branch', models.ForeignKey(blank=True, db_constraint=False, help_text='Sede donde se ejecuta el contrato', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.branch', verbose_name='Sede')),
                ('department', models.ForeignKey(blank=True, db_constraint=False, help_text='Departamento según el contrato', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.department', verbose_name='Departamento')),
                ('employee', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.employee', verbose_name='Empleado')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('job_position', models.ForeignKey(blank=True, db_constraint=False, help_text='Cargo seleccionado de la estructura organizacional', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.jobposition', verbose_name='Cargo Estructurado')),
                ('salary_currency', models.ForeignKey(blank=True, db_constraint=False, help_text='Moneda en la que se pacta el salario (generalmente USD)', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='customers.currency', verbose_name='Moneda del Salario')),
            ],
            options={
                'verbose_name': 'historical Contrato Laboral',
                'verbose_name_plural': 'historical Contratos Laborales',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalLoan',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('description', models.CharField(help_text='Ej: Anticipo Prestaciones, Préstamo Personal', max_length=200, verbose_name='Descripción')),
                ('amount', models.DecimalField(decimal_places=2, help_text='Monto original solicitado (Sin incluir intereses)', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto Principal')),
                ('interest_rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Porcentaje de ganancia o interés administrativo (0-100)', max_digits=5, verbose_name='Tasa de Interés (%)')),
                ('balance', models.DecimalField(blank=True, decimal_places=2, help_text='Monto que resta por pagar (Incluye intereses)', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Saldo Pendiente')),
                ('num_installments', models.PositiveIntegerField(blank=True, help_text='Número de cuotas para pagar. Si se define, calcula la cuota automáticamente.', null=True, verbose_name='Nro. Cuotas')),
                ('installment_amount', models.DecimalField(blank=True, decimal_places=2, help_text='Monto a descontar por evento de nómina', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto Cuota')),
                ('frequency', models.CharField(choices=[('ALL', 'Todas las Nóminas'), ('2ND_Q', 'Solo 2da Quincena (Fin de Mes)')], default='ALL', max_length=10, verbose_name='Frecuencia de Cobro')),
                ('status', models.CharField(choices=[('DRAFT', 'Borrador'), ('APPROVED', 'Aprobado'), ('ACTIVE', 'Activo'), ('PAID', 'Pagado'), ('CANCELLED', 'Anulado')], default='DRAFT', max_length=10, verbose_name='Estado')),
                ('start_date', models.DateField(help_text='Fecha a partir de la cual se comienza a cobrar', verbose_name='Fecha Inicio')),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('updated_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('currency', models.ForeignKey(blank=True, db_constraint=False, help_text='Moneda del préstamo (USD o VES)', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='customers.currency', verbose_name='Moneda')),
                ('employee', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.employee', verbose_name='Empleado')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Préstamo / Anticipo',
                'verbose_name_plural': 'historical Préstamos y Anticipos',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalPayrollPolicy',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('holiday_payout_factor', models.DecimalField(decimal_places=2, default=Decimal('1.50'), help_text='Multiplicador para días feriados trabajados (ej: 1.50)', max_digits=5, verbose_name='Factor Feriados')),
                ('rest_day_payout_factor', models.DecimalField(decimal_places=2, default=Decimal('1.50'), help_text='Multiplicador para días de descanso trabajados', max_digits=5, verbose_name='Factor Descansos')),
                ('overtime_day_factor', models.DecimalField(decimal_places=2, default=Decimal('1.50'), help_text='Recargo para horas extras diurnas (ej: 1.50 = 50% recargo)', max_digits=5, verbose_name='Horas Extra Diurnas')),
                ('overtime_night_factor', models.DecimalField(decimal_places=2, default=Decimal('1.50'), help_text='Recargo para horas extras nocturnas', max_digits=5, verbose_name='Horas Extra Nocturnas')),
                ('night_bonus_rate', models.DecimalField(decimal_places=2, default=Decimal('0.30'), help_text='Porcentaje de recargo por bono nocturno (ej: 0.30 = 30%)', max_digits=5, verbose_name='Bono Nocturno (%)')),
                ('vacation_days_base', models.PositiveSmallIntegerField(default=15, help_text='Días correspondientes al primer año (Art. 190)', verbose_name='Días Base Vacaciones')),
                ('vacation_days_per_year', models.PositiveSmallIntegerField(default=1, help_text='Días adicionales por cada año de servicio', verbose_name='Días Adicionales por Año')),
                ('vacation_days_max', models.PositiveSmallIntegerField(default=15, help_text='Tope de días adicionales acumulables (Total máx = Base + Máx)', verbose_name='Máximo Días Adicionales')),
                ('vacation_bonus_days_base', models.PositiveSmallIntegerField(default=15, help_text='Días de bono para el primer año (Art. 192)', verbose_name='Días Base Bono Vacacional')),
                ('vacation_bonus_days_per_year', models.PositiveSmallIntegerField(default=1, help_text='Días adicionales de bono por cada año de servicio', verbose_name='Días Adicionales Bono por Año')),
                ('vacation_bonus_days_max', models.PositiveSmallIntegerField(default=30, help_text='Tope máximo de días de bono vacacional', verbose_name='Máximo Días Bono Vacacional')),
                ('min_service_months', models.PositiveSmallIntegerField(default=12, help_text='Antigüedad mínima en meses para generar derecho a vacaciones (LOTTT: 12)', verbose_name='Meses Mínimos para Derecho')),
                ('pay_rest_days', models.BooleanField(default=True, help_text='Incluir sábados/domingos del período vacacional en el pago', verbose_name='Pagar Días de Descanso')),
                ('pay_holidays', models.BooleanField(default=True, help_text='Incluir feriados nacionales del período vacacional en el pago', verbose_name='Pagar Feriados')),
                ('accrual_mode', models.CharField(choices=[('ANNUAL', 'Anual (Al cumplir cada año)'), ('MONTHLY', 'Mensual Proporcional'), ('PROPORTIONAL', 'Proporcional a Días Trabajados')], default='ANNUAL', help_text='Cómo se acumulan los días de vacaciones', max_length=15, verbose_name='Modo de Acumulación')),
                ('minimum_wage_ves', models.DecimalField(decimal_places=2, default=Decimal('130.00'), help_text='Salario mínimo mensual vigente en VES. Usado como tope IVSS.', max_digits=18, verbose_name='Salario Mínimo (Bs.)')),
                ('imii_usd', models.DecimalField(decimal_places=2, default=Decimal('130.00'), help_text='Ingreso Mínimo Integral Indexado en USD. Piso para LPPSS.', max_digits=10, verbose_name='IMII (USD)')),
                ('cestaticket_amount_usd', models.DecimalField(decimal_places=2, default=Decimal('40.00'), help_text='Monto legal del cestaticket en USD.', max_digits=10, verbose_name='Cestaticket (USD)')),
                ('ut_value_ves', models.DecimalField(decimal_places=2, default=Decimal('9.00'), help_text='Valor de la Unidad Tributaria vigente. Usado para cálculos ISLR.', max_digits=12, verbose_name='Valor UT (Bs.)')),
                ('ivss_employee_rate', models.DecimalField(decimal_places=2, default=Decimal('4.00'), help_text='Porcentaje de IVSS a cargo del trabajador', max_digits=5, verbose_name='IVSS Empleado (%)')),
                ('rpe_employee_rate', models.DecimalField(decimal_places=2, default=Decimal('0.50'), help_text='Paro Forzoso a cargo del trabajador', max_digits=5, verbose_name='RPE Empleado (%)')),
                ('faov_employee_rate', models.DecimalField(decimal_places=2, default=Decimal('1.00'), help_text='FAOV (Vivienda) a cargo del trabajador', max_digits=5, verbose_name='FAOV Empleado (%)')),
                ('lppss_rate', models.DecimalField(decimal_places=2, default=Decimal('9.00'), help_text='Contribución Especial de Pensiones (LPPSS). Actualmente 9%.', max_digits=5, verbose_name='LPPSS (%)')),
                ('inces_employer_rate', models.DecimalField(decimal_places=2, default=Decimal('2.00'), help_text='Contribución patronal INCES. Actualmente 2%.', max_digits=5, verbose_name='INCES Patronal (%)')),
                ('ivss_salary_cap_multiplier', models.PositiveSmallIntegerField(default=5, help_text='El IVSS se calcula sobre un máximo de N salarios mínimos', verbose_name='Tope IVSS (x SM)')),
                ('updated_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('company', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='payroll_core.company', verbose_name='Empresa')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Política de Nómina',
                'verbose_name_plural': 'historical Políticas de Nómina',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
    ]
